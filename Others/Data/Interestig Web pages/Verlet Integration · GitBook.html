<!DOCTYPE html>
<!-- saved from url=(0085)https://www.algorithm-archive.org/contents/verlet_integration/verlet_integration.html -->
<html lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        
        <title>Verlet Integration · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="./Verlet Integration · GitBook_files/style.css">

    
            
                
                <link rel="stylesheet" href="./Verlet Integration · GitBook_files/website.css">
                
            
                
                <link rel="stylesheet" href="./Verlet Integration · GitBook_files/style(1).css">
                
            
                
                <link rel="stylesheet" href="./Verlet Integration · GitBook_files/api-language-selector.css">
                
            
                
                <link rel="stylesheet" href="./Verlet Integration · GitBook_files/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="./Verlet Integration · GitBook_files/search.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="./Verlet Integration · GitBook_files/website(1).css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.algorithm-archive.org/gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="https://www.algorithm-archive.org/gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="https://www.algorithm-archive.org/contents/quantum_systems/quantum_systems.html">
    
    
    <link rel="prev" href="https://www.algorithm-archive.org/contents/physics_solvers/physics_solvers.html">
    

    <script async="" src="./Verlet Integration · GitBook_files/analytics.js.descarga"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.6.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.6.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.6.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.6.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.6.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.6.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.6.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.6.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.6.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.6.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.6.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
    <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
        
<div class="book without-animation with-summary font-size-2 font-family-1">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="https://www.algorithm-archive.org/">
            
                    
                    Algorithm Archive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/introduction.html">
            
                <a href="https://www.algorithm-archive.org/contents/introduction/introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../how_to_contribute/how_to_contribute.html">
            
                <a href="https://www.algorithm-archive.org/contents/how_to_contribute/how_to_contribute.html">
            
                    
                    How To Contribute
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../data_structures/data_structures.html">
            
                <a href="https://www.algorithm-archive.org/contents/data_structures/data_structures.html">
            
                    
                    Data Structures
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../stacks_and_queues/stacks_and_queues.html">
            
                <a href="https://www.algorithm-archive.org/contents/stacks_and_queues/stacks_and_queues.html">
            
                    
                    Stacks and Queues
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../mathematical_background/mathematical_background.html">
            
                <a href="https://www.algorithm-archive.org/contents/mathematical_background/mathematical_background.html">
            
                    
                    Mathematical Background
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../notation/notation.html">
            
                <a href="https://www.algorithm-archive.org/contents/notation/notation.html">
            
                    
                    Complexity Notation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../bitlogic/bitlogic.html">
            
                <a href="https://www.algorithm-archive.org/contents/bitlogic/bitlogic.html">
            
                    
                    Bit Logic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../taylor_series_expansion/taylor_series_expansion.html">
            
                <a href="https://www.algorithm-archive.org/contents/taylor_series_expansion/taylor_series_expansion.html">
            
                    
                    Taylor Series
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../sorting_and_searching/sorting_and_searching.html">
            
                <a href="https://www.algorithm-archive.org/contents/sorting_and_searching/sorting_and_searching.html">
            
                    
                    Sorting and Searching
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../bubble_sort/bubble_sort.html">
            
                <a href="https://www.algorithm-archive.org/contents/bubble_sort/bubble_sort.html">
            
                    
                    Bubble Sort
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../bogo_sort/bogo_sort.html">
            
                <a href="https://www.algorithm-archive.org/contents/bogo_sort/bogo_sort.html">
            
                    
                    Bogo Sort
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../tree_traversal/tree_traversal.html">
            
                <a href="https://www.algorithm-archive.org/contents/tree_traversal/tree_traversal.html">
            
                    
                    Tree Traversal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../euclidean_algorithm/euclidean_algorithm.html">
            
                <a href="https://www.algorithm-archive.org/contents/euclidean_algorithm/euclidean_algorithm.html">
            
                    
                    Euclidean Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../monte_carlo_integration/monte_carlo_integration.html">
            
                <a href="https://www.algorithm-archive.org/contents/monte_carlo_integration/monte_carlo_integration.html">
            
                    
                    Monte Carlo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../matrix_methods/matrix_methods.html">
            
                <a href="https://www.algorithm-archive.org/contents/matrix_methods/matrix_methods.html">
            
                    
                    Matrix Methods
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../gaussian_elimination/gaussian_elimination.html">
            
                <a href="https://www.algorithm-archive.org/contents/gaussian_elimination/gaussian_elimination.html">
            
                    
                    Gaussian Elimination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../thomas_algorithm/thomas_algorithm.html">
            
                <a href="https://www.algorithm-archive.org/contents/thomas_algorithm/thomas_algorithm.html">
            
                    
                    Thomas Algorithm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../computational_geometry/computational_geometry.html">
            
                <a href="https://www.algorithm-archive.org/contents/computational_geometry/computational_geometry.html">
            
                    
                    Computational Geometry
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../gift_wrapping/gift_wrapping.html">
            
                <a href="https://www.algorithm-archive.org/contents/gift_wrapping/gift_wrapping.html">
            
                    
                    Gift Wrapping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1.1" data-path="../jarvis_march/jarvis_march.html">
            
                <a href="https://www.algorithm-archive.org/contents/jarvis_march/jarvis_march.html">
            
                    
                    Jarvis March
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.2" data-path="../graham_scan/graham_scan.html">
            
                <a href="https://www.algorithm-archive.org/contents/graham_scan/graham_scan.html">
            
                    
                    Graham Scan
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../cooley_tukey/cooley_tukey.html">
            
                <a href="https://www.algorithm-archive.org/contents/cooley_tukey/cooley_tukey.html">
            
                    
                    FFT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../decision_problems/decision_problems.html">
            
                <a href="https://www.algorithm-archive.org/contents/decision_problems/decision_problems.html">
            
                    
                    Decision Problems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../stable_marriage_problem/stable_marriage_problem.html">
            
                <a href="https://www.algorithm-archive.org/contents/stable_marriage_problem/stable_marriage_problem.html">
            
                    
                    Stable Marriage Problem
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../differential_equations/differential_equations.html">
            
                <a href="https://www.algorithm-archive.org/contents/differential_equations/differential_equations.html">
            
                    
                    Differential Equation Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../forward_euler_method/forward_euler_method.html">
            
                <a href="https://www.algorithm-archive.org/contents/forward_euler_method/forward_euler_method.html">
            
                    
                    Forward Euler Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../physics_solvers/physics_solvers.html">
            
                <a href="https://www.algorithm-archive.org/contents/physics_solvers/physics_solvers.html">
            
                    
                    Physics Solvers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.15.1" data-path="verlet_integration.html">
            
                <a href="https://www.algorithm-archive.org/contents/verlet_integration/verlet_integration.html">
            
                    
                    Verlet Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="../quantum_systems/quantum_systems.html">
            
                <a href="https://www.algorithm-archive.org/contents/quantum_systems/quantum_systems.html">
            
                    
                    Quantum Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.2.1" data-path="../split-operator_method/split-operator_method.html">
            
                <a href="https://www.algorithm-archive.org/contents/split-operator_method/split-operator_method.html">
            
                    
                    Split-Operator Method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../data_compression/data_compression.html">
            
                <a href="https://www.algorithm-archive.org/contents/data_compression/data_compression.html">
            
                    
                    Data Compression
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../huffman_encoding/huffman_encoding.html">
            
                <a href="https://www.algorithm-archive.org/contents/huffman_encoding/huffman_encoding.html">
            
                    
                    Huffman Encoding
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../quantum_information/quantum_information.html">
            
                <a href="https://www.algorithm-archive.org/contents/quantum_information/quantum_information.html">
            
                    
                    Quantum Information
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com/" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <a class="btn pull-left js-toolbar-action" aria-label="" href="https://www.algorithm-archive.org/contents/verlet_integration/verlet_integration.html#"><i class="fa fa-align-justify"></i></a><div class="dropdown pull-left font-settings js-toolbar-action"><a class="btn toggle-dropdown" aria-label="Font Settings" href="https://www.algorithm-archive.org/contents/verlet_integration/verlet_integration.html#"><i class="fa fa-font"></i></a><div class="dropdown-menu dropdown-right"><div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div><div class="buttons"><button class="button size-2 font-reduce">A</button><button class="button size-2 font-enlarge">A</button></div><div class="buttons"><button class="button size-2 ">Serif</button><button class="button size-2 ">Sans</button></div><div class="buttons"><button class="button size-3 ">White</button><button class="button size-3 ">Sepia</button><button class="button size-3 ">Night</button></div></div></div><div class="dropdown pull-left language-picker js-toolbar-action"><a class="btn toggle-dropdown" aria-label="Change language" href="https://www.algorithm-archive.org/contents/verlet_integration/verlet_integration.html#"><i class="fa fa-code"></i><span class="active-name">Julia</span></a><div class="dropdown-menu dropdown-right"><div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div></div></div><div class="dropdown pull-right js-toolbar-action"><a class="btn toggle-dropdown" aria-label="Share" href="https://www.algorithm-archive.org/contents/verlet_integration/verlet_integration.html#"><i class="fa fa-share-alt"></i></a><div class="dropdown-menu dropdown-left"><div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div><div class="buttons"><button class="button size-5 ">Facebook</button><button class="button size-5 ">Google+</button><button class="button size-5 ">Twitter</button><button class="button size-5 ">Weibo</button><button class="button size-5 ">Instapaper</button></div></div></div><a class="btn pull-right js-toolbar-action" aria-label="" href="https://www.algorithm-archive.org/contents/verlet_integration/verlet_integration.html#"><i class="fa fa-facebook"></i></a><a class="btn pull-right js-toolbar-action" aria-label="" href="https://www.algorithm-archive.org/contents/verlet_integration/verlet_integration.html#"><i class="fa fa-twitter"></i></a><h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="https://www.algorithm-archive.org/">Verlet Integration</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="verlet-integration">Verlet Integration</h1>
<p>Verlet integration is essentially a solution to the kinematic equation for the motion of any object,</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" role="math" style="width: 17.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.378em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.628em, 1014.27em, 3.023em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="msubsup" id="MathJax-Span-5" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 0.992em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="mn" id="MathJax-Span-7" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-8" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="msubsup" id="MathJax-Span-9" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.471em;"><span class="mn" id="MathJax-Span-11" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-14" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-15" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-16" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-18"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-20" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-22" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-23" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-24" style="font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math-italic;">b</span><span class="msubsup" id="MathJax-Span-26"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.211em;">⋯</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.934em; border-left: 0px solid; width: 0px; height: 2.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><msub><mi>v</mi><mn>0</mn></msub><mi>t</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>a</mi><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mfrac><mn>1</mn><mn>6</mn></mfrac><mi>b</mi><msup><mi>t</mi><mn>3</mn></msup><mo>+</mo><mo>⋯</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">
x = x_0 + v_0t + \frac{1}{2}at^2 + \frac{1}{6}bt^3 + \cdots
</script></p>
<p>where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" role="math" style="width: 0.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex; " id="MathJax-Element-2">x</script> is the position, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-34" role="math" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.513em, 1000.47em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-35"><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex; " id="MathJax-Element-3">v</script> is the velocity, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-37" role="math" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex; " id="MathJax-Element-4">a</script> is the acceleration, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-40" role="math" style="width: 0.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1000.42em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex; " id="MathJax-Element-5">b</script> is the often forgotten jerk term, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-43" role="math" style="width: 0.471em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.357em, 1000.32em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex; " id="MathJax-Element-6">t</script> is time. This equation is a central equation to almost every Newtonian physics solver and brings up a class of algorithms known as <em>force integrators</em>. One of the first force integrators to work with is <em>Verlet Integration</em>.</p>
<p>So, let's say we want to solve for the next timestep in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-46" role="math" style="width: 0.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex; " id="MathJax-Element-7">x</script>. To a close approximation (actually performing a Taylor Series Expansion about <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x00B1;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-49" role="math" style="width: 4.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.117em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1004.01em, 2.555em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-50"><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.211em;">±</span><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>±</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex; " id="MathJax-Element-8">x(t\pm \Delta t)</script>), that might look like this:</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-58" role="math" style="width: 31.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.096em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.628em, 1025.99em, 3.023em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">x</span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">v</span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-80" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-81" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-82" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-92" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-93" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-94" style="font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-100"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-102" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="texatom" id="MathJax-Span-104" style="padding-left: 0.211em;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-109"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-111" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.934em; border-left: 0px solid; width: 0px; height: 2.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mfrac><mn>1</mn><mn>6</mn></mfrac><mi>b</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>3</mn></msup><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>4</mn></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-9">
x(t+\Delta t) = x(t) + v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 + \frac{1}{6}b(t) \Delta t^3 + \mathcal{O}(\Delta t^4)
</script></p>
<p>This means that if we need to find the next <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-113" role="math" style="width: 0.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-114"><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex; " id="MathJax-Element-10">x</script>, we need the current <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-116" role="math" style="width: 0.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-117"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex; " id="MathJax-Element-11">x</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-119" role="math" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.513em, 1000.47em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-120"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex; " id="MathJax-Element-12">v</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-122" role="math" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-123"><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex; " id="MathJax-Element-13">a</script>, etc. However, because few people calculate the jerk term, our error is typically <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-125" role="math" style="width: 3.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.148em, 1003.08em, 2.555em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-126"><span class="texatom" id="MathJax-Span-127"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-132"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.367em;"><span class="mn" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>3</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex; " id="MathJax-Element-14">\mathcal{O}(\Delta t^3)</script>. That said, we can calculate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-136" role="math" style="width: 0.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-137"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex; " id="MathJax-Element-15">x</script> with less knowledge and higher accuracy if we play a trick! Let's say we want to calculate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-139" role="math" style="width: 0.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex; " id="MathJax-Element-16">x</script> of the <em>previous</em> timestep. Again, to a close approximation, that might look like this:</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-142" role="math" style="width: 31.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.096em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.628em, 1025.99em, 3.023em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-143"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main; padding-left: 0.211em;">−</span><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">x</span><span class="mo" id="MathJax-Span-153" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main; padding-left: 0.211em;">−</span><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">v</span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-164" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-165" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-166" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-168" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-172"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-174" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-175" style="font-family: MathJax_Main; padding-left: 0.211em;">−</span><span class="mfrac" id="MathJax-Span-176" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-177" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-178" style="font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-184"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="texatom" id="MathJax-Span-188" style="padding-left: 0.211em;"><span class="mrow" id="MathJax-Span-189"><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-193"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-195" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.934em; border-left: 0px solid; width: 0px; height: 2.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup><mo>−</mo><mfrac><mn>1</mn><mn>6</mn></mfrac><mi>b</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>3</mn></msup><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>4</mn></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">
x(t-\Delta t) = x(t) - v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 - \frac{1}{6}b(t) \Delta t^3 + \mathcal{O}(\Delta t^4)
</script></p>
<p>Now, we have two equations to solve for two different timesteps in x, one of which we already have. If we add the two equations together and solve for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-197" role="math" style="width: 4.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.117em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1004.01em, 2.555em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-198"><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-200" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-201" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-202" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex; " id="MathJax-Element-18">x(t+\Delta t)</script>, we find that</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-206" role="math" style="width: 26.201em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.826em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1021.72em, 2.555em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-207"><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-214" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mn" id="MathJax-Span-216" style="font-family: MathJax_Main; padding-left: 0.263em;">2</span><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main; padding-left: 0.211em;">−</span><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">x</span><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-225" style="font-family: MathJax_Main; padding-left: 0.211em;">−</span><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-229" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-235"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-237" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="texatom" id="MathJax-Span-239" style="padding-left: 0.211em;"><span class="mrow" id="MathJax-Span-240"><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-244"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-246" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>4</mn></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">
x(t+ \Delta t) = 2x(t) - x(t-\Delta t) + a(t)\Delta t^2 + \mathcal{O}(\Delta t^4)
</script></p>
<p>So, this means we can find our next <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-248" role="math" style="width: 0.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex; " id="MathJax-Element-20">x</script> simply by knowing our current <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-251" role="math" style="width: 0.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-252"><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex; " id="MathJax-Element-21">x</script>, the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-254" role="math" style="width: 0.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-255"><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex; " id="MathJax-Element-22">x</script> before that, and the acceleration! No velocity necessary! In addition, this drops the error to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-257" role="math" style="width: 3.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.148em, 1003.08em, 2.555em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-258"><span class="texatom" id="MathJax-Span-259"><span class="mrow" id="MathJax-Span-260"><span class="mi" id="MathJax-Span-261" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-262" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-264"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-265" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.367em;"><span class="mn" id="MathJax-Span-266" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>4</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex; " id="MathJax-Element-23">\mathcal{O}(\Delta t^4)</script>, which is great!
Here is what it looks like in code:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp"><span class="token keyword">double</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">double</span> next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> next_pos<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// Note that we are using a temp variable for the previous position</span>
  <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">;</span>
  prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> next_pos

    <span class="token keyword">return</span> time
</code></pre>
</div><div class="code-method-sample hidden" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token keyword">type</span> <span class="token constant">Method</span> <span class="token operator">=</span> <span class="token constant">Model</span> <span class="token operator">-&gt;</span> <span class="token constant">Time</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span>

<span class="token hvariable">verlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">verlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span>'<span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x</span>' <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v</span>' <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token hvariable">a</span>' <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="scratch" data-name="Scratch"><p>Unfortunately, this has not yet been implemented in scratch, so here's Julia code:</p>
<pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="matlab" data-name="Matlab"><p>Unfortunately, this has not yet been implemented in matlab, so here's Julia code:</p>
<pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="LabVIEW" data-name="LabVIEW"><p>Unfortunately, this has not yet been implemented in LabVIEW, so here's Julia code:</p>
<pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="javascript" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prevPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> tempPos<span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    tempPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prevPos <span class="token operator">=</span> tempPos<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token keyword">fn</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span> f64<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> f64 <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        <span class="token keyword">let</span> temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    time
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="swift" data-name="Swift"><pre class="language-"><code class="lang-swift"><span class="token keyword">func</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Double</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">:</span> <span class="token builtin">Double</span>
    <span class="token keyword">var</span> prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> time
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="f90" data-name="Fortran90"><pre class="language-"><code class="lang-fortran"><span class="token keyword">SUBROUTINE</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos


    prev_pos <span class="token operator">=</span> pos
    time     <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time     <span class="token operator">=</span> time <span class="token operator">+</span> dt
            next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2d0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span>
            prev_pos <span class="token operator">=</span> pos
            pos      <span class="token operator">=</span> next_pos
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> verlet
</code></pre>
</div><div class="code-method-sample hidden" data-lang="ruby" data-name="Ruby"><pre class="language-"><code class="lang-ruby"><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time

<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prevPos <span class="token operator">:=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        nextPos <span class="token operator">:=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        prevPos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> nextPos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="asm-x64" data-name="X86-64 Assembly"><pre class="language-"><code class="lang-asm-x64"># <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
<span class="token label function">verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    verlet_return
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm1</span>                  # <span class="token register variable">xmm6</span> <span class="token operator">=</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm0</span>                  # Holds previous position
<span class="token label function">verlet_loop:</span>
  addsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm2</span>                  # Adding dt to time
  movsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm0</span>                  # Hold old value of posistion
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                  # Calculating new position
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm4</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if position is greater then <span class="token number">0.0</span>
  ja     verlet_loop
<span class="token label function">verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm3</span>                  # Saving time value
  ret
</code></pre>
</div><div class="code-method-sample hidden" data-lang="kotlin" data-name="Kotlin"><pre class="language-"><code class="lang-kotlin"><span class="token keyword">fun</span> <span class="token function">verlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> Double <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos  <span class="token comment">// Since function parameter are val and can't be modified</span>
    <span class="token keyword">var</span> prevPos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        <span class="token keyword">val</span> nextPos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prevPos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> nextPos
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> time
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="nim" data-name="Nim"><pre class="language-"><code class="lang-nim"><span class="token keyword">proc</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> float <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    prevPos<span class="token operator">:</span> float <span class="token operator">=</span> pos
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    tempPos<span class="token operator">:</span> float

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    tempPos <span class="token operator">=</span> pos
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    prevPos <span class="token operator">=</span> tempPos

  <span class="token keyword">return</span> time
</code></pre>
</div><div class="code-method-sample hidden" data-lang="lisp" data-name="Common Lisp"><pre class="language-"><code class="lang-lisp"><span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">"Integrates Newton's equation for motion while pos &gt; 0 using Verlet integration."</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    with prev-pos = pos
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> pos <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment">;; The starting speed is assumed to be zero.</span>
    do <span class="token punctuation">(</span><span class="token car">psetf</span>
         pos <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> pos <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">-</span> prev-pos<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
         prev-pos pos<span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div></div></div>

<p>Now, obviously this poses a problem; what if we want to calculate a term that requires velocity, like the kinetic energy, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-268" role="math" style="width: 3.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.503em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1002.5em, 2.659em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-269"><span class="mfrac" id="MathJax-Span-270"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.388em, 1000.32em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.154em;"><span class="mn" id="MathJax-Span-271" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1000.32em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.154em;"><span class="mn" id="MathJax-Span-272" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.47em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.471em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math-italic;">m</span><span class="msubsup" id="MathJax-Span-274"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-275" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.471em;"><span class="mn" id="MathJax-Span-276" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>m</mi><msup><mi>v</mi><mn>2</mn></msup></math></span></span><script type="math/tex; " id="MathJax-Element-24">\frac{1}{2}mv^2</script>? In this case, we certainly cannot get rid of the velocity! Well, we can find the velocity to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-277" role="math" style="width: 3.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.148em, 1003.08em, 2.555em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-278"><span class="texatom" id="MathJax-Span-279"><span class="mrow" id="MathJax-Span-280"><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-284"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.367em;"><span class="mn" id="MathJax-Span-286" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex; " id="MathJax-Element-25">\mathcal{O}(\Delta t^2)</script> accuracy by using the Stormer-Verlet method, which is the same as before, but we calculate velocity like so</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-288" role="math" style="width: 20.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.086em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.523em, 1016.98em, 2.971em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-289"><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mfrac" id="MathJax-Span-295" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 9.534em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.128em, 1009.33em, 4.43em, -999.997em); top: -4.737em; left: 50%; margin-left: -4.685em;"><span class="mrow" id="MathJax-Span-296"><span class="mi" id="MathJax-Span-297" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-298" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-299" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main; padding-left: 0.211em;">−</span><span class="mi" id="MathJax-Span-305" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">x</span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main; padding-left: 0.211em;">−</span><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-311" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1001.67em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-312"><span class="mn" id="MathJax-Span-313" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1009.53em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 9.534em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="texatom" id="MathJax-Span-317" style="padding-left: 0.211em;"><span class="mrow" id="MathJax-Span-318"><span class="mi" id="MathJax-Span-319" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-320" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-322"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-324" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-325" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-26">
v(t) = \frac{x(t+\Delta t) - x(t-\Delta t)}{2\Delta t} + \mathcal{O}(\Delta t^2)
</script></p>
<p>Note that the 2 in the denominator appears because we are going over 2 timesteps. It's essentially solving <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-326" role="math" style="width: 3.701em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.076em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.044em, 1003.08em, 2.711em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-327"><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mfrac" id="MathJax-Span-330" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 1.096em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.336em, 1000.94em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.518em;"><span class="mrow" id="MathJax-Span-331"><span class="mi" id="MathJax-Span-332" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-333" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.84em, 4.169em, -999.997em); top: -3.591em; left: 50%; margin-left: -0.414em;"><span class="mrow" id="MathJax-Span-334"><span class="mi" id="MathJax-Span-335" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-336" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1001.1em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 1.096em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo>=</mo><mfrac><mrow><mi mathvariant="normal">Δ</mi><mi>x</mi></mrow><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></mfrac></math></span></span><script type="math/tex; " id="MathJax-Element-27">v=\frac{\Delta x}{\Delta t}</script>. In addition, we can calculate the velocity of the next timestep like so</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-337" role="math" style="width: 20.003em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.669em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.523em, 1016.57em, 2.971em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mfrac" id="MathJax-Span-347" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 7.138em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.128em, 1006.93em, 4.43em, -999.997em); top: -4.737em; left: 50%; margin-left: -3.487em;"><span class="mrow" id="MathJax-Span-348"><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-351" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-354" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-356" style="font-family: MathJax_Main; padding-left: 0.211em;">−</span><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">x</span><span class="mo" id="MathJax-Span-358" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-360" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1001.15em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.57em;"><span class="mrow" id="MathJax-Span-361"><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1007.14em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 7.138em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mo" id="MathJax-Span-364" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="texatom" id="MathJax-Span-365" style="padding-left: 0.211em;"><span class="mrow" id="MathJax-Span-366"><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-370" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-371" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">
v(t+\Delta t) = \frac{x(t+\Delta t) - x(t)}{\Delta t} + \mathcal{O}(\Delta t)
</script></p>
<p>However, the error for this is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-372" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1002.66em, 2.555em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-373"><span class="texatom" id="MathJax-Span-374"><span class="mrow" id="MathJax-Span-375"><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-377" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-379" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex; " id="MathJax-Element-29">\mathcal{O}(\Delta t)</script>, which is quite poor, but it gets the job done in a pinch.  Here's what it looks like in code:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        <span class="token comment"># Because acceleration is constant, velocity is straightforward</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp">timestep <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">double</span> next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> next_pos<span class="token punctuation">;</span>

    <span class="token comment">// The acceleration is constant, so the velocity is</span>
    <span class="token comment">// straightforward</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> timestep <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>vel<span class="token punctuation">,</span>
                    <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token operator">*</span>vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

        <span class="token operator">*</span>vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">static</span> <span class="token class-name">VerletValues</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// Note that we are using a temp variable for the previous position</span>
    <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

        <span class="token comment">// The acceleration is constant, so the velocity is straightforward</span>
         vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

   <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> next_pos
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
</code></pre>
</div><div class="code-method-sample hidden" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token hvariable">stormerVerlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">stormerVerlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span>'<span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x</span>' <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v</span>' <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>' <span class="token operator">-</span> <span class="token hvariable">x</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token hvariable">dt</span>
    <span class="token hvariable">a</span>' <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="scratch" data-name="Scratch"><p>Unfortunately, this has not yet been implemented in scratch, so here's Julia code:</p>
<pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        <span class="token comment"># Because acceleration is constant, velocity is straightforward</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="matlab" data-name="Matlab"><p>Unfortunately, this has not yet been implemented in matlab, so here's Julia code:</p>
<pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        <span class="token comment"># Because acceleration is constant, velocity is straightforward</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="LabVIEW" data-name="LabVIEW"><p>Unfortunately, this has not yet been implemented in LabVIEW, so here's Julia code:</p>
<pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        <span class="token comment"># Because acceleration is constant, velocity is straightforward</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="javascript" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prevPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> tempPos<span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    tempPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prevPos <span class="token operator">=</span> tempPos<span class="token punctuation">;</span>

    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token keyword">fn</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span> f64<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span>f64<span class="token punctuation">,</span> f64<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        <span class="token keyword">let</span> temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

        <span class="token comment">// Because acceleration is constant, velocity is</span>
        <span class="token comment">// straightforward</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="swift" data-name="Swift"><pre class="language-"><code class="lang-swift"><span class="token keyword">func</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token builtin">Double</span>
    <span class="token keyword">var</span> prev_pos <span class="token operator">=</span> pos
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span>vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="f90" data-name="Fortran90"><pre class="language-"><code class="lang-fortran"><span class="token keyword">SUBROUTINE</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos

    prev_pos <span class="token operator">=</span> pos 
    time     <span class="token operator">=</span> <span class="token number">0d0</span>
    vel      <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time     <span class="token operator">=</span> time <span class="token operator">+</span> dt
            next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span>
            prev_pos <span class="token operator">=</span> pos
            pos      <span class="token operator">=</span> next_pos
            vel      <span class="token operator">=</span> vel <span class="token operator">+</span> acc <span class="token operator">*</span> dt
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> stormer_verlet
</code></pre>
</div><div class="code-method-sample hidden" data-lang="ruby" data-name="Ruby"><pre class="language-"><code class="lang-ruby"><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">stormer_verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    prev_pos <span class="token operator">=</span> pos
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time

<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prevPos <span class="token operator">:=</span> pos
    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
        nextPos <span class="token operator">:=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        prevPos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> nextPos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="asm-x64" data-name="X86-64 Assembly"><pre class="language-"><code class="lang-asm-x64"># <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
# RET <span class="token register variable">xmm1</span> <span class="token operator">-</span> velocity
<span class="token label function">stormer_verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    stormer_verlet_return
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm1</span>                  # <span class="token register variable">xmm6</span> <span class="token operator">=</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm0</span>                  # Holds previous position
<span class="token label function">stormer_verlet_loop:</span>
  addsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm2</span>                  # Adding dt to time
  movsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm0</span>                  # Hold old value of posistion
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                  # Calculating new position
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm4</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if position is greater then <span class="token number">0.0</span>
  ja     stormer_verlet_loop
<span class="token label function">stormer_verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm3</span>                  # Saving time and velocity
  mulsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  movsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm3</span>
  ret
</code></pre>
</div><div class="code-method-sample hidden" data-lang="kotlin" data-name="Kotlin"><pre class="language-"><code class="lang-kotlin"><span class="token keyword">fun</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> VerletValues <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos
    <span class="token keyword">var</span> prevPos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">var</span> vel <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        <span class="token keyword">val</span> nextPos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prevPos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> nextPos
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="nim" data-name="Nim"><pre class="language-"><code class="lang-nim"><span class="token keyword">proc</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span>float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    prevPos<span class="token operator">:</span> float <span class="token operator">=</span> pos
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    vel<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    tempPos<span class="token operator">:</span> float

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    tempPos <span class="token operator">=</span> pos
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    prevPos <span class="token operator">=</span> tempPos

    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

  <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="lisp" data-name="Common Lisp"><pre class="language-"><code class="lang-lisp"><span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">stormer-verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">"Integrates Newton's equation for motion while pos &gt; 0 using the Stormer-Verlet method."</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    with prev-pos = pos
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    for vel = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> vel <span class="token punctuation">(</span><span class="token car">*</span> acc dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> pos <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment">;; Variables are changed simultaneously by 'psetf', so there's no need for a temporary variable.</span>
    do <span class="token punctuation">(</span><span class="token car">psetf</span>
         pos <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> pos <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">-</span> prev-pos<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
         prev-pos pos<span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token car">list</span> time vel<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div></div></div>


<p>Now, let's say we actually need the velocity to calculate out next timestep. Well, in this case, we simply cannot use the above approximation and instead need to use the <em>Velocity Verlet</em> algorithm.</p>
<h1 id="velocity-verlet">Velocity Verlet</h1>
<p>In some ways, this algorithm is even simpler than above. We can calculate everything like</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-381" role="math" style="width: 22.034em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.336em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-1.143em, 1018.13em, 4.898em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-382"><span class="mtable" id="MathJax-Span-383" style="padding-right: 0.159em; padding-left: 0.159em;"><span style="display: inline-block; position: relative; width: 18.023em; height: 0px;"><span style="position: absolute; clip: rect(3.023em, 1004.01em, 8.023em, -999.997em); top: -5.674em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 4.117em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1004.01em, 4.43em, -999.997em); top: -5.779em; right: 0.003em;"><span class="mtd" id="MathJax-Span-384"><span class="mrow" id="MathJax-Span-385"><span class="mi" id="MathJax-Span-386" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-389" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-392" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1003.96em, 4.43em, -999.997em); top: -4.008em; right: 0.003em;"><span class="mtd" id="MathJax-Span-420"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-423" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-425" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-427" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1003.91em, 4.43em, -999.997em); top: -2.081em; right: 0.003em;"><span class="mtd" id="MathJax-Span-443"><span class="mrow" id="MathJax-Span-444"><span class="mi" id="MathJax-Span-445" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-446" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-448" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-449" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.68em;"></span></span><span style="position: absolute; clip: rect(3.44em, 1013.86em, 9.482em, -999.997em); top: -6.716em; left: 4.117em;"><span style="display: inline-block; position: relative; width: 13.909em; height: 0px;"><span style="position: absolute; clip: rect(2.503em, 1012.4em, 4.846em, -999.997em); top: -5.779em; left: 0.003em;"><span class="mtd" id="MathJax-Span-393"><span class="mrow" id="MathJax-Span-394"><span class="mi" id="MathJax-Span-395"></span><span class="mo" id="MathJax-Span-396" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">x</span><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-400" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-401" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">v</span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-409" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-410" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-411" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-412" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-413" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-416" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-417"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.367em;"><span class="mn" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1006.67em, 4.43em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mtd" id="MathJax-Span-429"><span class="mrow" id="MathJax-Span-430"><span class="mi" id="MathJax-Span-431"></span><span class="mo" id="MathJax-Span-432" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-439" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-440" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.503em, 1013.86em, 4.846em, -999.997em); top: -2.081em; left: 0.003em;"><span class="mtd" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="mi" id="MathJax-Span-454"></span><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">v</span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-458" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-460" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-461" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-462" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-463" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mo" id="MathJax-Span-464" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-465" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-466" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-467" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-469" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-470" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">a</span><span class="mo" id="MathJax-Span-471" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-474" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-475" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-476" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.721em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.184em; border-left: 0px solid; width: 0px; height: 7.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup></mtd></mtr><mtr><mtd><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">
\begin{align}
x(t+\Delta t) &=x(t) + v(t)\Delta t + \frac{1}{2}a(t)\Delta t^2 \\
a(t+\Delta t) &= f(x(t+\Delta t)) \\
v(t+\Delta t) &= v(t) + \frac{1}{2}(a(t) + a(t+\Delta t))\Delta t
\end{align}
</script></p>
<p>which is literally the kinematic equation above, solving for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-480" role="math" style="width: 0.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-481"><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex; " id="MathJax-Element-31">x</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-483" role="math" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.513em, 1000.47em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-484"><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex; " id="MathJax-Element-32">v</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-486" role="math" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.52em, 2.294em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-487"><span class="mi" id="MathJax-Span-488" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex; " id="MathJax-Element-33">a</script> every timestep. You can also split up the equations like so</p>
<p><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-489" role="math" style="width: 22.451em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.701em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-2.289em, 1018.49em, 6.044em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-490"><span class="mtable" id="MathJax-Span-491" style="padding-right: 0.159em; padding-left: 0.159em;"><span style="display: inline-block; position: relative; width: 18.388em; height: 0px;"><span style="position: absolute; clip: rect(4.169em, 1004.79em, 12.086em, -999.997em); top: -8.591em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 4.898em; height: 0px;"><span style="position: absolute; clip: rect(2.503em, 1004.79em, 4.846em, -999.997em); top: -6.924em; right: 0.003em;"><span class="mtd" id="MathJax-Span-492"><span class="mrow" id="MathJax-Span-493"><span class="mi" id="MathJax-Span-494" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-495" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-496" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-497" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-498" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-499" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-500" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-502" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-503" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1004.01em, 4.43em, -999.997em); top: -4.581em; right: 0.003em;"><span class="mtd" id="MathJax-Span-522"><span class="mrow" id="MathJax-Span-523"><span class="mi" id="MathJax-Span-524" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-525" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-528" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-530" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1003.96em, 4.43em, -999.997em); top: -2.81em; right: 0.003em;"><span class="mtd" id="MathJax-Span-552"><span class="mrow" id="MathJax-Span-553"><span class="mi" id="MathJax-Span-554" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-556" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-558" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-560" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1003.91em, 4.43em, -999.997em); top: -0.935em; right: 0.003em;"><span class="mtd" id="MathJax-Span-575"><span class="mrow" id="MathJax-Span-576"><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-578" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-580" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-582" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-583" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.596em;"></span></span><span style="position: absolute; clip: rect(4.586em, 1013.49em, 12.919em, -999.997em); top: -9.008em; left: 4.898em;"><span style="display: inline-block; position: relative; width: 13.492em; height: 0px;"><span style="position: absolute; clip: rect(2.503em, 1007.82em, 4.846em, -999.997em); top: -6.924em; left: 0.003em;"><span class="mtd" id="MathJax-Span-504"><span class="mrow" id="MathJax-Span-505"><span class="mi" id="MathJax-Span-506"></span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-508" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">v</span><span class="mo" id="MathJax-Span-509" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-512" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-513" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-514" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-515" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-517" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.503em, 1010.26em, 4.846em, -999.997em); top: -4.581em; left: 0.003em;"><span class="mtd" id="MathJax-Span-531"><span class="mrow" id="MathJax-Span-532"><span class="mi" id="MathJax-Span-533"></span><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-535" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">x</span><span class="mo" id="MathJax-Span-536" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-537" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-539" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-540" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">v</span><span class="mo" id="MathJax-Span-541" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-544" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-545" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-546" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-547" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-549" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1006.67em, 4.43em, -999.997em); top: -2.81em; left: 0.003em;"><span class="mtd" id="MathJax-Span-561"><span class="mrow" id="MathJax-Span-562"><span class="mi" id="MathJax-Span-563"></span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-567" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-568" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-569" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-570" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-571" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-573" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-574" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(2.503em, 1013.49em, 4.846em, -999.997em); top: -0.935em; left: 0.003em;"><span class="mtd" id="MathJax-Span-584"><span class="mrow" id="MathJax-Span-585"><span class="mi" id="MathJax-Span-586"></span><span class="mo" id="MathJax-Span-587" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-588" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">v</span><span class="mo" id="MathJax-Span-589" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-590" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-591" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-592" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-593" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-594" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-596" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-598" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mfrac" id="MathJax-Span-599" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-600" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.258em;"><span class="mn" id="MathJax-Span-601" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.63em, 1.201em, -999.997em); top: -1.247em; left: 0.003em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0.003em; border-top: 1.3px solid; width: 0.628em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-603" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-604" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-605" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-606" style="font-family: MathJax_Main; padding-left: 0.211em;">Δ</span><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.559em; border-left: 0px solid; width: 0px; height: 9.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mtd></mtr><mtr><mtd><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mtd></mtr><mtr><mtd><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-34">
\begin{align}
v(t+\frac{1}{2}\Delta t) &= v(t) + \frac{1}{2}a(t)\Delta t \\
x(t+\Delta t) &=x(t) + v(t+\frac{1}{2}\Delta t)\Delta t \\
a(t+\Delta t) &= f(x(t+\Delta t)) \\
v(t+\Delta t) &= v(t+\frac{1}{2}\Delta t) + \frac{1}{2}a(t+\Delta t)\Delta t
\end{align}
</script></p>
<p>Here is the velocity Verlet method in code:</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp">timestep <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> timestep <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>vel<span class="token punctuation">,</span>
                     <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">*</span>vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        pos <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">*</span>vel<span class="token punctuation">)</span> <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        <span class="token operator">*</span>vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">static</span> <span class="token class-name">VerletValues</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// Note that we are using a temp variable for the previous position</span>
    <span class="token keyword">double</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">;</span>
    vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        pos <span class="token operator">+=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
</code></pre>
</div><div class="code-method-sample hidden" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token hvariable">velocityVerlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">velocityVerlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">aOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">v</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span>'<span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x</span>' <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v</span>' <span class="token operator">=</span> <span class="token hvariable">v</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token hvariable">aOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token hvariable">dt</span>
    <span class="token hvariable">a</span>' <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="scratch" data-name="Scratch"><p>Unfortunately, this has not yet been implemented in scratch, so here's Julia code:</p>
<pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="matlab" data-name="Matlab"><p>Unfortunately, this has not yet been implemented in matlab, so here's Julia code:</p>
<pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="LabVIEW" data-name="LabVIEW"><p>Unfortunately, this has not yet been implemented in LabVIEW, so here's Julia code:</p>
<pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="javascript" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token keyword">fn</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span> f64<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span>f64<span class="token punctuation">,</span> f64<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="swift" data-name="Swift"><pre class="language-"><code class="lang-swift"><span class="token keyword">func</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">:</span> <span class="token builtin">Double</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        pos <span class="token operator">+</span><span class="token operator">=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span>vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="f90" data-name="Fortran90"><pre class="language-"><code class="lang-fortran"><span class="token keyword">SUBROUTINE</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel

    time     <span class="token operator">=</span> <span class="token number">0d0</span>
    vel      <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time <span class="token operator">=</span> time <span class="token operator">+</span> dt
            pos  <span class="token operator">=</span> pos <span class="token operator">+</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5d0</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span> 
            vel  <span class="token operator">=</span> vel <span class="token operator">+</span> acc <span class="token operator">*</span> dt
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> velocity_verlet
</code></pre>
</div><div class="code-method-sample hidden" data-lang="ruby" data-name="Ruby"><pre class="language-"><code class="lang-ruby"><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">velocity_verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        pos <span class="token operator">+</span><span class="token operator">=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time

<span class="token keyword">end</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">.5</span><span class="token operator">*</span>acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="asm-x64" data-name="X86-64 Assembly"><pre class="language-"><code class="lang-asm-x64"># <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
# RET <span class="token register variable">xmm1</span> <span class="token operator">-</span> velocity
<span class="token label function">velocity_verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds the velocity value
  pxor   <span class="token register variable">xmm4</span>, <span class="token register variable">xmm4</span>                  # Holds the time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    velocity_verlet_return
  movsd  <span class="token register variable">xmm5</span>, half                  # <span class="token register variable">xmm5</span> <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">*</span> dt <span class="token operator">*</span> dt <span class="token operator">*</span> acc
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm1</span>
<span class="token label function">velocity_verlet_loop:</span>
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm3</span>                  # Move velocity into register
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>                  # Calculate new position
  addsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  addsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm2</span>                  # Incrementing time
  movsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm4</span>                  # Updating velocity
  mulsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>
  ja     velocity_verlet_loop
<span class="token label function">velocity_verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm4</span>                  # Saving time and velocity
  movsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm3</span>
  ret
</code></pre>
</div><div class="code-method-sample hidden" data-lang="kotlin" data-name="Kotlin"><pre class="language-"><code class="lang-kotlin"><span class="token keyword">fun</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> VerletValues <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">var</span> vel <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="nim" data-name="Nim"><pre class="language-"><code class="lang-nim"><span class="token keyword">proc</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span>float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    vel<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

  <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="lisp" data-name="Common Lisp"><pre class="language-"><code class="lang-lisp"><span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">velocity-verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">"Integrates Newton's equation for motion while pos &gt; 0 using the velocity in calculations."</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    for vel = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> vel <span class="token punctuation">(</span><span class="token car">*</span> acc dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
    for p = pos then <span class="token punctuation">(</span><span class="token car">incf</span> p <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> vel dt<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> <span class="token number">0.5</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> p <span class="token number">0</span><span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token car">list</span> time vel<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div></div></div>

<p>Even though this method is more widely used than the simple Verlet method mentioned above, it unforunately has an error term of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-611" role="math" style="width: 3.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.148em, 1003.08em, 2.555em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-612"><span class="texatom" id="MathJax-Span-613"><span class="mrow" id="MathJax-Span-614"><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-616" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-617" style="font-family: MathJax_Main;">Δ</span><span class="msubsup" id="MathJax-Span-618"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px;"><span style="position: absolute; clip: rect(3.232em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-619" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.367em;"><span class="mn" id="MathJax-Span-620" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-621" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex; " id="MathJax-Element-35">\mathcal{O}(\Delta t^2)</script>, which is two orders of magnitude worse. That said, if you want to have a simulaton with many objects that depend on one another --- like a gravity simulation --- the Velocity Verlet algorithm is a handy choice; however, you may have to play further tricks to allow everything to scale appropriately. These types of simulatons are sometimes called <em>n-body</em> simulations and one such trick is the Barnes-Hut algorithm, which cuts the complexity of n-body simulations from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-622" role="math" style="width: 4.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.648em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.148em, 1003.54em, 2.555em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-623"><span class="mo" id="MathJax-Span-624" style="font-family: MathJax_Main;">∼</span><span class="texatom" id="MathJax-Span-625" style="padding-left: 0.263em;"><span class="mrow" id="MathJax-Span-626"><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-628" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-629"><span style="display: inline-block; position: relative; width: 1.044em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;"><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.628em;"><span class="mn" id="MathJax-Span-631" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-632" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>∼</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex; " id="MathJax-Element-36">\sim \mathcal{O}(n^2)</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;O&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-633" role="math" style="width: 7.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.044em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1005.94em, 2.555em, -999.997em); top: -2.133em; left: 0.003em;"><span class="mrow" id="MathJax-Span-634"><span class="mo" id="MathJax-Span-635" style="font-family: MathJax_Main;">∼</span><span class="texatom" id="MathJax-Span-636" style="padding-left: 0.263em;"><span class="mrow" id="MathJax-Span-637"><span class="mi" id="MathJax-Span-638" style="font-family: MathJax_Caligraphic;">O</span></span></span><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-640" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Main; padding-left: 0.159em;">log</span><span class="mo" id="MathJax-Span-642"></span><span class="mo" id="MathJax-Span-643" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-644" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-645" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-646" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>∼</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">O</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex; " id="MathJax-Element-37">\sim \mathcal{O}(n\log(n))</script>.</p>
<h2 id="video-explanation">Video Explanation</h2>
<p>Here is a video describing Verlet integration:</p>
<div style="text-align:center">
<iframe width="560" height="315" src="./Verlet Integration · GitBook_files/g55QvpAev0I.html" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</div>

<h2 id="example-code">Example Code</h2>
<p>Both of these methods work simply by iterating timestep-by-timestep and can be written straightforwardly in any language. For reference, here are snippets of code that use both the classic and velocity Verlet methods to find the time it takes for a ball to hit the ground after being dropped from a given height.</p>
<div class="code-method"><div class="code-method-definition"></div><div class="code-method-code"><div class="code-method-sample" data-lang="jl" data-name="Julia"><pre class="language-"><code class="lang-julia"><span class="token keyword">function</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time
<span class="token keyword">end</span>

<span class="token keyword">function</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        <span class="token comment"># Because acceleration is constant, velocity is straightforward</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>

<span class="token keyword">function</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span><span class="token punctuation">:</span>Float64<span class="token punctuation">)</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>
    vel <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">end</span>

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel
<span class="token keyword">end</span>

<span class="token keyword">function</span> main<span class="token punctuation">(</span><span class="token punctuation">)</span>
    time <span class="token operator">=</span> verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">"Time for Verlet integration is: $(time)\n"</span><span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> stormer_verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">"Time for Stormer Verlet integration is: $(time)"</span><span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">"Velocity for Stormer Verlet integration is: $(vel)\n"</span><span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> velocity_verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">"Time for velocity Verlet integration is: $(time)"</span><span class="token punctuation">)</span>
    <span class="token keyword">println</span><span class="token punctuation">(</span><span class="token string">"Velocity for velocity Verlet integration is: $(vel)\n"</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="cpp" data-name="C++"><pre class="language-"><code class="lang-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iomanip&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">struct</span> <span class="token class-name">timestep</span> <span class="token punctuation">{</span>
  <span class="token keyword">double</span> time<span class="token punctuation">;</span>
  <span class="token keyword">double</span> vel<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">double</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">double</span> next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> next_pos<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

timestep <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    <span class="token keyword">double</span> next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> next_pos<span class="token punctuation">;</span>

    <span class="token comment">// The acceleration is constant, so the velocity is</span>
    <span class="token comment">// straightforward</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> timestep <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

timestep <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> timestep <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>fixed <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">setprecision</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Note that depending on the simulation, you might want to have the</span>
  <span class="token comment">// Verlet loop outside.</span>

  <span class="token comment">// For example, if your acceleration chages as a function of time,</span>
  <span class="token comment">// you might need to also change the acceleration to be read into</span>
  <span class="token comment">// each of these functions.</span>

  <span class="token keyword">double</span> time <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Time for Verlet integration is: "</span> \
            <span class="token operator">&lt;&lt;</span> time <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>

  timestep timestep_sv <span class="token operator">=</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Time for Stormer Verlet integration is: "</span> \
            <span class="token operator">&lt;&lt;</span> timestep_sv<span class="token punctuation">.</span>time <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Velocity for Stormer Verlet integration is: "</span> \
            <span class="token operator">&lt;&lt;</span> timestep_sv<span class="token punctuation">.</span>vel <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>

  timestep timestep_vv <span class="token operator">=</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Time for velocity Verlet integration is: "</span> \
            <span class="token operator">&lt;&lt;</span> timestep_vv<span class="token punctuation">.</span>time <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
  std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Velocity for velocity Verlet integration is: "</span> \
            <span class="token operator">&lt;&lt;</span> timestep_vv<span class="token punctuation">.</span>vel <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="c" data-name="C"><pre class="language-"><code class="lang-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>vel<span class="token punctuation">,</span>
                    <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">;</span>
    prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token operator">*</span>vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

        <span class="token operator">*</span>vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>time<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">*</span>vel<span class="token punctuation">,</span>
                     <span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">*</span>vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        pos <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">*</span>vel<span class="token punctuation">)</span> <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        <span class="token operator">*</span>vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">double</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">;</span>

    <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>time<span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Time for Verlet integration is: %lf\n"</span><span class="token punctuation">,</span>
           time<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>time<span class="token punctuation">,</span> <span class="token operator">&amp;</span>vel<span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Time and velocity for Stormer Verlet integration is: %lf, %lf\n"</span><span class="token punctuation">,</span>
           time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>time<span class="token punctuation">,</span> <span class="token operator">&amp;</span>vel<span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Time and velocity for velocity Verlet integration is: %lf, %lf\n"</span><span class="token punctuation">,</span>
           time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="java" data-name="Java"><pre class="language-"><code class="lang-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VerletValues</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> time<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> vel<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">VerletValues</span><span class="token punctuation">(</span><span class="token keyword">double</span> time<span class="token punctuation">,</span> <span class="token keyword">double</span> vel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>time <span class="token operator">=</span> time<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>vel <span class="token operator">=</span> vel<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Verlet</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

      <span class="token comment">// Note that we are using a temp variable for the previous position</span>
      <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">;</span>
      prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
      time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

      <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
            temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
            pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
            prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> time<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">VerletValues</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// Note that we are using a temp variable for the previous position</span>
        <span class="token keyword">double</span> prev_pos<span class="token punctuation">,</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
            temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
            pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
            prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

            <span class="token comment">// The acceleration is constant, so the velocity is straightforward</span>
             vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token class-name">VerletValues</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">double</span> pos<span class="token punctuation">,</span> <span class="token keyword">double</span> acc<span class="token punctuation">,</span> <span class="token keyword">double</span> dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// Note that we are using a temp variable for the previous position</span>
        <span class="token keyword">double</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">;</span>
        vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
            pos <span class="token operator">+=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
            vel <span class="token operator">+=</span> acc<span class="token operator">*</span>dt<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">double</span> verletTime <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Time for Verlet integration is: "</span> <span class="token operator">+</span> verletTime<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">VerletValues</span> stormerVerlet <span class="token operator">=</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Time for Stormer Verlet integration is: "</span> <span class="token operator">+</span> stormerVerlet<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Velocity for Stormer Verlet integration is: "</span> <span class="token operator">+</span> stormerVerlet<span class="token punctuation">.</span>vel<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">VerletValues</span> velocityVerlet <span class="token operator">=</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Time for velocity Verlet integration is: "</span> <span class="token operator">+</span> velocityVerlet<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Velocity for velocity Verlet integration is: "</span> <span class="token operator">+</span> velocityVerlet<span class="token punctuation">.</span>vel<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="py" data-name="Python"><pre class="language-"><code class="lang-python"><span class="token keyword">def</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> next_pos

    <span class="token keyword">return</span> time

<span class="token keyword">def</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> next_pos
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel

<span class="token keyword">def</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

    <span class="token keyword">return</span> time<span class="token punctuation">,</span> vel

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    time <span class="token operator">=</span> verlet<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Verlet"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Time: {:.10f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> stormer_verlet<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Stormer-Verlet"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Time: {:.10f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Velocity: {:.10f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>vel<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> velocity_verlet<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Velocity Verlet"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Time: {:.10f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Velocity: {:.10f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>vel<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="hs" data-name="Haskell"><pre class="language-"><code class="lang-haskell"><span class="token comment">-- submitted by Jie</span>
<span class="token keyword">type</span> <span class="token constant">Time</span> <span class="token operator">=</span> <span class="token constant">Double</span>

<span class="token keyword">type</span> <span class="token constant">Position</span> <span class="token operator">=</span> <span class="token constant">Double</span>

<span class="token keyword">type</span> <span class="token constant">Speed</span> <span class="token operator">=</span> <span class="token constant">Double</span>

<span class="token keyword">type</span> <span class="token constant">Acceleration</span> <span class="token operator">=</span> <span class="token constant">Double</span>

<span class="token keyword">type</span> <span class="token constant">Particle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">Position</span><span class="token punctuation">,</span> <span class="token constant">Speed</span><span class="token punctuation">,</span> <span class="token constant">Acceleration</span><span class="token punctuation">,</span> <span class="token constant">Time</span><span class="token punctuation">)</span>

<span class="token keyword">type</span> <span class="token constant">Model</span> <span class="token operator">=</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token constant">Acceleration</span>

<span class="token keyword">type</span> <span class="token constant">Method</span> <span class="token operator">=</span> <span class="token constant">Model</span> <span class="token operator">-&gt;</span> <span class="token constant">Time</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span>

<span class="token hvariable">verlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">verlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span>'<span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x</span>' <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v</span>' <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token hvariable">a</span>' <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>

<span class="token hvariable">stormerVerlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">stormerVerlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span>'<span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x</span>' <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v</span>' <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>' <span class="token operator">-</span> <span class="token hvariable">x</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token hvariable">dt</span>
    <span class="token hvariable">a</span>' <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>

<span class="token hvariable">velocityVerlet</span> <span class="token operator">::</span> <span class="token constant">Method</span>
<span class="token hvariable">velocityVerlet</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token punctuation">(</span><span class="token hvariable">xOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">aOld</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">v</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span>'<span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">x</span>' <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">xOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v</span>' <span class="token operator">=</span> <span class="token hvariable">v</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token hvariable">aOld</span> <span class="token operator">+</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token hvariable">dt</span>
    <span class="token hvariable">a</span>' <span class="token operator">=</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>

<span class="token hvariable">trajectory</span> <span class="token operator">::</span> <span class="token constant">Method</span> <span class="token operator">-&gt;</span> <span class="token constant">Model</span> <span class="token operator">-&gt;</span> <span class="token constant">Time</span> <span class="token operator">-&gt;</span> <span class="token constant">Particle</span> <span class="token operator">-&gt;</span> <span class="token punctuation">[</span><span class="token constant">Particle</span><span class="token punctuation">]</span>
<span class="token hvariable">trajectory</span> <span class="token hvariable">method</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span> <span class="token hvariable">p0</span><span class="token operator">@</span><span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">v</span><span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t0</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">traj</span>
  <span class="token keyword">where</span>
    <span class="token hvariable">traj</span> <span class="token operator">=</span> <span class="token hvariable">p0</span> <span class="token operator">:</span> <span class="token hvariable">p1</span> <span class="token operator">:</span> <span class="token builtin">zipWith</span> <span class="token punctuation">(</span><span class="token hvariable">method</span> <span class="token hvariable">acc</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span> <span class="token hvariable">traj</span> <span class="token punctuation">(</span><span class="token builtin">tail</span> <span class="token hvariable">traj</span><span class="token punctuation">)</span>
    <span class="token hvariable">p1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">acc</span> <span class="token punctuation">(</span><span class="token hvariable">x</span>'<span class="token punctuation">,</span> <span class="token hvariable">v</span>'<span class="token punctuation">,</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token hvariable">t0</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token hvariable">t0</span> <span class="token operator">+</span> <span class="token hvariable">dt</span><span class="token punctuation">)</span>
    <span class="token hvariable">x</span>' <span class="token operator">=</span> <span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token hvariable">v</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span> <span class="token operator">^</span> <span class="token number">2</span>
    <span class="token hvariable">v</span>' <span class="token operator">=</span> <span class="token hvariable">v</span> <span class="token operator">+</span> <span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token hvariable">dt</span>

<span class="token hvariable">main</span> <span class="token operator">::</span> <span class="token constant">IO</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token hvariable">main</span> <span class="token operator">=</span> <span class="token keyword">do</span>
  <span class="token keyword">let</span> <span class="token hvariable">p0</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
      <span class="token hvariable">dt</span> <span class="token operator">=</span> <span class="token number">0.001</span>
      <span class="token hvariable">freefall</span> <span class="token hvariable">_</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">10</span>
      <span class="token hvariable">aboveGround</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">x</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
      <span class="token hvariable">integrate</span> <span class="token hvariable">m</span> <span class="token operator">=</span> <span class="token builtin">last</span> <span class="token operator">$</span> <span class="token builtin">takeWhile</span> <span class="token hvariable">aboveGround</span> <span class="token operator">$</span> <span class="token hvariable">trajectory</span> <span class="token hvariable">m</span> <span class="token hvariable">freefall</span> <span class="token hvariable">dt</span> <span class="token hvariable">p0</span>
  <span class="token builtin">print</span> <span class="token operator">$</span> <span class="token hvariable">integrate</span> <span class="token hvariable">verlet</span>
  <span class="token builtin">print</span> <span class="token operator">$</span> <span class="token hvariable">integrate</span> <span class="token hvariable">stormerVerlet</span>
  <span class="token builtin">print</span> <span class="token operator">$</span> <span class="token hvariable">integrate</span> <span class="token hvariable">velocityVerlet</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="scratch" data-name="Scratch"><p>Submitted by Jie</p>
<p></p><p>
    <img class="center" src="./Verlet Integration · GitBook_files/verlet_scratch.png">
</p>
Link: <a href="https://scratch.mit.edu/projects/173039394/" target="_blank">https://scratch.mit.edu/projects/173039394/</a><p></p>
</div><div class="code-method-sample hidden" data-lang="matlab" data-name="Matlab"><pre class="language-"><code class="lang-matlab"><span class="token comment">% Submitted by P. Mekhail</span>
<span class="token comment">% Parameters to change</span>
n <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>        <span class="token comment">% Number of steps</span>
x0 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>         <span class="token comment">% Ball starting height(in metres)</span>
v0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>         <span class="token comment">% Ball starting velocity (+ive is up)</span>
dt <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>      <span class="token comment">% Time step (in seconds)</span>
eff <span class="token operator">=</span> <span class="token number">0.4</span><span class="token punctuation">;</span>      <span class="token comment">% Ball efficency when bouncing</span>
A <span class="token operator">=</span> <span class="token operator">@</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">;</span>   <span class="token comment">% Acceleration as a function of position</span>
bounce <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token comment">% Do you want the ball to bounce?</span>

<span class="token comment">% Making position and time vectors</span>
x <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
t <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">:</span>dt<span class="token operator">:</span>n<span class="token operator">*</span>dt<span class="token operator">-</span>dt<span class="token punctuation">;</span>

<span class="token comment">% Setting the initial conditions</span>
<span class="token function">x</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> x0<span class="token punctuation">;</span>
<span class="token function">x</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> x0 <span class="token operator">+</span> v0<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span><span class="token function">A</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span><span class="token operator">*</span>dt<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">% Runnin Verlet Integration</span>
<span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">:</span>n<span class="token operator">-</span><span class="token number">1</span>
    xnew <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>dt<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> bounce
        <span class="token keyword">if</span> xnew <span class="token operator">&gt;</span> <span class="token number">0</span>
            <span class="token comment">% If you haven't hit the ground keep going</span>
            <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> xnew<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token comment">% If you have calculated velocity and invert its sign</span>
            v <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>eff<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>xnew<span class="token operator">-</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>dt<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">-</span> v<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>dt<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">else</span>
        <span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> xnew<span class="token punctuation">;</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
<span class="token function">plot</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>x<span class="token punctuation">)</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Ball''s Trajectory'</span><span class="token punctuation">)</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'Time (s)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'Height (m)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="LabVIEW" data-name="LabVIEW"><p>Submitted by P. Mekhail</p>
<p>
    <img class="center" src="./Verlet Integration · GitBook_files/verlet_labview.png">
</p></div><div class="code-method-sample hidden" data-lang="javascript" data-name="JavaScript"><pre class="language-"><code class="lang-javascript"><span class="token keyword">function</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prevPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> tempPos<span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    tempPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prevPos <span class="token operator">=</span> tempPos<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> time<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> prevPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> tempPos<span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    tempPos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    prevPos <span class="token operator">=</span> tempPos<span class="token punctuation">;</span>

    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token parameter">pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Time for Verlet integration is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>time<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> stormer <span class="token operator">=</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Time for Stormer Verlet integration is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>stormer<span class="token punctuation">.</span>time<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Velocity for Stormer Verlet integration is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>stormer<span class="token punctuation">.</span>vel<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> velocity <span class="token operator">=</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Time for Velocity Verlet integration is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>velocity<span class="token punctuation">.</span>time<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Velocity for Velocity Verlet integration is: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>velocity<span class="token punctuation">.</span>vel<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="rs" data-name="Rust"><pre class="language-"><code class="lang-rust"><span class="token keyword">fn</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span> f64<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> f64 <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        <span class="token keyword">let</span> temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    time
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span> f64<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span>f64<span class="token punctuation">,</span> f64<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> prev_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        <span class="token keyword">let</span> temp_pos <span class="token operator">=</span> pos<span class="token punctuation">;</span>
        pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2.0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        prev_pos <span class="token operator">=</span> temp_pos<span class="token punctuation">;</span>

        <span class="token comment">// Because acceleration is constant, velocity is</span>
        <span class="token comment">// straightforward</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token keyword">mut</span> pos<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> acc<span class="token punctuation">:</span> f64<span class="token punctuation">,</span> dt<span class="token punctuation">:</span> f64<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span>f64<span class="token punctuation">,</span> f64<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> time <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> vel <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt<span class="token punctuation">;</span>
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> time_v <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>time_sv<span class="token punctuation">,</span> vel_sv<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">stormer_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>time_vv<span class="token punctuation">,</span> vel_vv<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">velocity_verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">println!</span><span class="token punctuation">(</span><span class="token string">"Time for original Verlet integration: {}"</span><span class="token punctuation">,</span> time_v<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println!</span><span class="token punctuation">(</span>
        <span class="token string">"Time and velocity for Stormer Verlet integration: {}, {}"</span><span class="token punctuation">,</span>
        time_sv<span class="token punctuation">,</span> vel_sv
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println!</span><span class="token punctuation">(</span>
        <span class="token string">"Time and velocity for velocity Verlet integration: {}, {}"</span><span class="token punctuation">,</span>
        time_vv<span class="token punctuation">,</span> vel_vv
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="swift" data-name="Swift"><pre class="language-"><code class="lang-swift"><span class="token keyword">func</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">Double</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">:</span> <span class="token builtin">Double</span>
    <span class="token keyword">var</span> prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> time
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> temp_pos<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token builtin">Double</span>
    <span class="token keyword">var</span> prev_pos <span class="token operator">=</span> pos
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span>vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> vel<span class="token punctuation">:</span> <span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time<span class="token punctuation">,</span> vel <span class="token punctuation">:</span> <span class="token builtin">Double</span>
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        pos <span class="token operator">+</span><span class="token operator">=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">:</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">:</span>vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> verletTime <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Time for Verlet integration is: <span class="token interpolation"><span class="token delimiter variable">\(</span>verletTime<span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> stormer <span class="token operator">=</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Time for Stormer Verlet integration is: <span class="token interpolation"><span class="token delimiter variable">\(</span>stormer<span class="token punctuation">.</span>time<span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Velocity for Stormer Verlet integration is: <span class="token interpolation"><span class="token delimiter variable">\(</span>stormer<span class="token punctuation">.</span>vel<span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> velVerlet <span class="token operator">=</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">:</span> <span class="token number">5.0</span><span class="token punctuation">,</span> acc<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> dt<span class="token punctuation">:</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Time for velocity Verlet integration is: <span class="token interpolation"><span class="token delimiter variable">\(</span>velVerlet<span class="token punctuation">.</span>time<span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Velocity for velocity Verlet integration is: <span class="token interpolation"><span class="token delimiter variable">\(</span>velVerlet<span class="token punctuation">.</span>vel<span class="token delimiter variable">)</span></span>"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="f90" data-name="Fortran90"><pre class="language-"><code class="lang-fortran"><span class="token keyword">SUBROUTINE</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos


    prev_pos <span class="token operator">=</span> pos
    time     <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time     <span class="token operator">=</span> time <span class="token operator">+</span> dt
            next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2d0</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span>
            prev_pos <span class="token operator">=</span> pos
            pos      <span class="token operator">=</span> next_pos
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> verlet

<span class="token keyword">SUBROUTINE</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos

    prev_pos <span class="token operator">=</span> pos 
    time     <span class="token operator">=</span> <span class="token number">0d0</span>
    vel      <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time     <span class="token operator">=</span> time <span class="token operator">+</span> dt
            next_pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span>
            prev_pos <span class="token operator">=</span> pos
            pos      <span class="token operator">=</span> next_pos
            vel      <span class="token operator">=</span> vel <span class="token operator">+</span> acc <span class="token operator">*</span> dt
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> stormer_verlet 

<span class="token keyword">SUBROUTINE</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
    <span class="token keyword">IMPLICIT NONE</span>
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel

    time     <span class="token operator">=</span> <span class="token number">0d0</span>
    vel      <span class="token operator">=</span> <span class="token number">0d0</span>

    <span class="token keyword">DO</span>
        <span class="token keyword">IF</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0d0</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span>
            time <span class="token operator">=</span> time <span class="token operator">+</span> dt
            pos  <span class="token operator">=</span> pos <span class="token operator">+</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5d0</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">**</span> <span class="token number">2</span> 
            vel  <span class="token operator">=</span> vel <span class="token operator">+</span> acc <span class="token operator">*</span> dt
        <span class="token keyword">ELSE</span>
            <span class="token keyword">EXIT</span>
        <span class="token keyword">END IF</span>
    <span class="token keyword">END DO</span>
<span class="token keyword">END SUBROUTINE</span> velocity_verlet 

<span class="token keyword">PROGRAM</span> verlet_integration

    <span class="token keyword">IMPLICIT NONE</span> 
    <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span>acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel

    <span class="token keyword">INTERFACE</span>
        <span class="token keyword">SUBROUTINE</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">)</span>
        <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time
        <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos
        <span class="token keyword">END SUBROUTINE</span>
    <span class="token keyword">END INTERFACE</span> 

    <span class="token keyword">INTERFACE</span> 
        <span class="token keyword">SUBROUTINE</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
            <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel
            <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos
        <span class="token keyword">END SUBROUTINE</span> 
    <span class="token keyword">END INTERFACE</span> 

    <span class="token keyword">INTERFACE</span> 
        <span class="token keyword">SUBROUTINE</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span> 
            <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTENT</span><span class="token punctuation">(</span><span class="token keyword">INOUT</span><span class="token punctuation">)</span> <span class="token operator">::</span> pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel
            <span class="token keyword">REAL</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>                <span class="token operator">::</span> prev_pos<span class="token punctuation">,</span> next_pos 
        <span class="token keyword">END SUBROUTINE</span> 
    <span class="token keyword">END INTERFACE</span> 

    pos <span class="token operator">=</span> <span class="token number">5d0</span>
    acc <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">10d0</span>
    dt  <span class="token operator">=</span> <span class="token number">0.01d0</span>
    <span class="token comment">! Verlet </span>
    <span class="token keyword">CALL</span> verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">)</span>

    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">'Time for Verlet integration: '</span><span class="token punctuation">,</span> time 

    <span class="token comment">! stormer Verlet </span>
    pos <span class="token operator">=</span> <span class="token number">5d0</span>
    <span class="token keyword">CALL</span> stormer_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>

    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">'Time for Stormer-Verlet integration: '</span><span class="token punctuation">,</span> time 

    <span class="token comment">! Velocity Verlet</span>
    pos <span class="token operator">=</span> <span class="token number">5d0</span>
    <span class="token keyword">CALL</span> velocity_verlet<span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">,</span> time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>

    <span class="token keyword">WRITE</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token string">'Time for Velocity-Verlet integration: '</span><span class="token punctuation">,</span> time 

<span class="token keyword">END PROGRAM</span> verlet_integration
</code></pre>
</div><div class="code-method-sample hidden" data-lang="ruby" data-name="Ruby"><pre class="language-"><code class="lang-ruby"><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    prev_pos <span class="token operator">=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time

<span class="token keyword">end</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">stormer_verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    prev_pos <span class="token operator">=</span> pos
    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        temp_pos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prev_pos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prev_pos <span class="token operator">=</span> temp_pos

        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time

<span class="token keyword">end</span>

<span class="token keyword">def</span> <span class="token method-definition"><span class="token function">velocity_verlet</span></span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token punctuation">)</span>

    vel <span class="token operator">=</span> <span class="token number">0</span>
    time <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">do</span>
        time <span class="token operator">+</span><span class="token operator">=</span> dt
        pos <span class="token operator">+</span><span class="token operator">=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token operator">*</span>acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+</span><span class="token operator">=</span> acc<span class="token operator">*</span>dt
    <span class="token keyword">end</span>

   <span class="token keyword">return</span> time

<span class="token keyword">end</span>

p verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
p stormer_verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
p velocity_verlet<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="go" data-name="Go"><pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prevPos <span class="token operator">:=</span> pos
    time <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        nextPos <span class="token operator">:=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        prevPos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> nextPos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prevPos <span class="token operator">:=</span> pos
    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
        nextPos <span class="token operator">:=</span> pos<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        prevPos<span class="token punctuation">,</span> pos <span class="token operator">=</span> pos<span class="token punctuation">,</span> nextPos
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>

    <span class="token keyword">for</span> pos <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel<span class="token operator">*</span>dt <span class="token operator">+</span> <span class="token number">.5</span><span class="token operator">*</span>acc<span class="token operator">*</span>dt<span class="token operator">*</span>dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time <span class="token operator">:=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.</span><span class="token punctuation">,</span> <span class="token number">.01</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Verlet"</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Time:"</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">:=</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token number">5.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.</span><span class="token punctuation">,</span> <span class="token number">.01</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Stormer-Verlet"</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Time:"</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Velocity:"</span><span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    time<span class="token punctuation">,</span> vel <span class="token operator">=</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token number">5.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.</span><span class="token punctuation">,</span> <span class="token number">.01</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Velocity Verlet"</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Time:"</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Velocity:"</span><span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="asm-x64" data-name="X86-64 Assembly"><pre class="language-"><code class="lang-asm-x64">.intel_syntax noprefix

.section .rodata
  <span class="token label function">zero:</span>          .double <span class="token number">0.0</span>
  <span class="token label function">two:</span>           .double <span class="token number">2.0</span>
  <span class="token label function">half:</span>          .double <span class="token number">0.5</span>
  <span class="token label function">verlet_fmt:</span>    .string <span class="token string">"Time for Verlet integration is: %lf\n"</span>
  <span class="token label function">stormer_fmt:</span>   .string <span class="token string">"Time and Velocity for Stormer Verlet Integration is: %lf, %lf\n"</span>
  <span class="token label function">velocity_fmt:</span>  .string <span class="token string">"Time and Velocity for Velocity Verlet Integration is: %lf, %lf\n"</span>
  <span class="token label function">pos:</span>           .double <span class="token number">5.0</span>
  <span class="token label function">acc:</span>           .double <span class="token operator">-</span><span class="token number">10.0</span>
  <span class="token label function">dt:</span>            .double <span class="token number">0.01</span>

.section .text
  .<span class="token keyword">global main</span>
  .<span class="token keyword">extern printf</span>

# <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
<span class="token label function">verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    verlet_return
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm1</span>                  # <span class="token register variable">xmm6</span> <span class="token operator">=</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm0</span>                  # Holds previous position
<span class="token label function">verlet_loop:</span>
  addsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm2</span>                  # Adding dt to time
  movsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm0</span>                  # Hold old value of posistion
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                  # Calculating new position
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm4</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if position is greater then <span class="token number">0.0</span>
  ja     verlet_loop
<span class="token label function">verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm3</span>                  # Saving time value
  ret

# <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
# RET <span class="token register variable">xmm1</span> <span class="token operator">-</span> velocity
<span class="token label function">stormer_verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    stormer_verlet_return
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm1</span>                  # <span class="token register variable">xmm6</span> <span class="token operator">=</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm0</span>                  # Holds previous position
<span class="token label function">stormer_verlet_loop:</span>
  addsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm2</span>                  # Adding dt to time
  movsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm0</span>                  # Hold old value of posistion
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm0</span>                  # Calculating new position
  subsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  movsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm4</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if position is greater then <span class="token number">0.0</span>
  ja     stormer_verlet_loop
<span class="token label function">stormer_verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm3</span>                  # Saving time and velocity
  mulsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  movsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm3</span>
  ret

# <span class="token register variable">xmm0</span> <span class="token operator">-</span> pos
# <span class="token register variable">xmm1</span> <span class="token operator">-</span> acc
# <span class="token register variable">xmm2</span> <span class="token operator">-</span> dt
# RET <span class="token register variable">xmm0</span> <span class="token operator">-</span> time
# RET <span class="token register variable">xmm1</span> <span class="token operator">-</span> velocity
<span class="token label function">velocity_verlet:</span>
  pxor   <span class="token register variable">xmm7</span>, <span class="token register variable">xmm7</span>                  # Holds <span class="token number">0</span> for comparisons
  pxor   <span class="token register variable">xmm3</span>, <span class="token register variable">xmm3</span>                  # Holds the velocity value
  pxor   <span class="token register variable">xmm4</span>, <span class="token register variable">xmm4</span>                  # Holds the time value
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>                  # Check if pos is greater then <span class="token number">0.0</span>
  jbe    velocity_verlet_return
  movsd  <span class="token register variable">xmm5</span>, half                  # <span class="token register variable">xmm5</span> <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">*</span> dt <span class="token operator">*</span> dt <span class="token operator">*</span> acc
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm2</span>
  mulsd  <span class="token register variable">xmm5</span>, <span class="token register variable">xmm1</span>
<span class="token label function">velocity_verlet_loop:</span>
  movsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm3</span>                  # Move velocity into register
  mulsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm2</span>                  # Calculate new position
  addsd  <span class="token register variable">xmm6</span>, <span class="token register variable">xmm5</span>
  addsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm6</span>
  addsd  <span class="token register variable">xmm4</span>, <span class="token register variable">xmm2</span>                  # Incrementing time
  movsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm4</span>                  # Updating velocity
  mulsd  <span class="token register variable">xmm3</span>, <span class="token register variable">xmm1</span>
  comisd <span class="token register variable">xmm0</span>, <span class="token register variable">xmm7</span>
  ja     velocity_verlet_loop
<span class="token label function">velocity_verlet_return:</span>
  movsd  <span class="token register variable">xmm0</span>, <span class="token register variable">xmm4</span>                  # Saving time and velocity
  movsd  <span class="token register variable">xmm1</span>, <span class="token register variable">xmm3</span>
  ret

<span class="token label function">main:</span>
  push   <span class="token register variable">rbp</span>
  movsd  <span class="token register variable">xmm0</span>, pos                   # Calling verlet
  movsd  <span class="token register variable">xmm1</span>, acc
  movsd  <span class="token register variable">xmm2</span>, dt
  call   verlet
  mov    <span class="token register variable">rdi</span>, OFFSET verlet_fmt      # Print output
  mov    <span class="token register variable">rax</span>, <span class="token number">1</span>
  call   printf
  movsd  <span class="token register variable">xmm0</span>, pos                   # Calling stormer_verlet
  movsd  <span class="token register variable">xmm1</span>, acc
  movsd  <span class="token register variable">xmm2</span>, dt
  call   stormer_verlet
  mov    <span class="token register variable">rdi</span>, OFFSET stormer_fmt     # Print output
  mov    <span class="token register variable">rax</span>, <span class="token number">1</span>
  call   printf
  movsd  <span class="token register variable">xmm0</span>, pos                   # Calling velocity_verlet
  movsd  <span class="token register variable">xmm1</span>, acc
  movsd  <span class="token register variable">xmm2</span>, dt
  call   velocity_verlet
  mov    <span class="token register variable">rdi</span>, OFFSET velocity_fmt    # Print output
  mov    <span class="token register variable">rax</span>, <span class="token number">1</span>
  call   printf
  pop    <span class="token register variable">rbp</span>
  ret
</code></pre>
</div><div class="code-method-sample hidden" data-lang="kotlin" data-name="Kotlin"><pre class="language-"><code class="lang-kotlin"><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">VerletValues</span><span class="token punctuation">(</span><span class="token keyword">val</span> time<span class="token operator">:</span> Double<span class="token punctuation">,</span> <span class="token keyword">val</span> vel<span class="token operator">:</span> Double<span class="token punctuation">)</span>

<span class="token keyword">fun</span> <span class="token function">verlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> Double <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos  <span class="token comment">// Since function parameter are val and can't be modified</span>
    <span class="token keyword">var</span> prevPos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        <span class="token keyword">val</span> nextPos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prevPos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> nextPos
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> time
<span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> VerletValues <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos
    <span class="token keyword">var</span> prevPos <span class="token operator">=</span> pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">var</span> vel <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        <span class="token keyword">val</span> nextPos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        prevPos <span class="token operator">=</span> pos
        pos <span class="token operator">=</span> nextPos
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>_pos<span class="token operator">:</span> Double<span class="token punctuation">,</span> acc<span class="token operator">:</span> Double<span class="token punctuation">,</span> dt<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> VerletValues <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> _pos
    <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">var</span> vel <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        time <span class="token operator">+=</span> dt
        pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
        vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">VerletValues</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> verletTime <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Time for Verlet integration is: <span class="token interpolation variable">$verletTime</span>"</span><span class="token punctuation">)</span>

    <span class="token keyword">val</span> stormerVerlet <span class="token operator">=</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Time for Stormer Verlet integration is: <span class="token interpolation variable">$stormerVerlet</span>.time"</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Velocity for Stormer Verlet integration is: <span class="token interpolation variable">$stormerVerlet</span>.vel"</span><span class="token punctuation">)</span>

    <span class="token keyword">val</span> velocityVerlet <span class="token operator">=</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Time for Velocity Verlet integration is: <span class="token interpolation variable">$velocityVerlet</span>.time"</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Velocity for Velocity Verlet integration is: <span class="token interpolation variable">$velocityVerlet</span>.vel"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><div class="code-method-sample hidden" data-lang="nim" data-name="Nim"><pre class="language-"><code class="lang-nim"><span class="token keyword">proc</span> <span class="token function">verlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> float <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    prevPos<span class="token operator">:</span> float <span class="token operator">=</span> pos
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    tempPos<span class="token operator">:</span> float

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    tempPos <span class="token operator">=</span> pos
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    prevPos <span class="token operator">=</span> tempPos

  <span class="token keyword">return</span> time

<span class="token keyword">proc</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span>float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    prevPos<span class="token operator">:</span> float <span class="token operator">=</span> pos
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    vel<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    tempPos<span class="token operator">:</span> float

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    tempPos <span class="token operator">=</span> pos
    pos <span class="token operator">=</span> pos <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> prevPos <span class="token operator">+</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    prevPos <span class="token operator">=</span> tempPos

    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

  <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>

<span class="token keyword">proc</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span>pos_in<span class="token punctuation">,</span> acc<span class="token punctuation">,</span> dt<span class="token operator">:</span> float<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span>float<span class="token punctuation">,</span> float<span class="token punctuation">)</span> <span class="token operator">=</span>
  <span class="token keyword">var</span>
    pos<span class="token operator">:</span> float <span class="token operator">=</span> pos_in
    time<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>
    vel<span class="token operator">:</span> float <span class="token operator">=</span> <span class="token number">0.0</span>

  <span class="token keyword">while</span> pos <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token operator">:</span>
    time <span class="token operator">+=</span> dt
    pos <span class="token operator">+=</span> vel <span class="token operator">*</span> dt <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> acc <span class="token operator">*</span> dt <span class="token operator">*</span> dt
    vel <span class="token operator">+=</span> acc <span class="token operator">*</span> dt

  <span class="token keyword">return</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span> vel<span class="token punctuation">)</span>

<span class="token keyword">let</span> timeV <span class="token operator">=</span> <span class="token function">verlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
echo <span class="token string">"Time for Verlet integration is: "</span><span class="token punctuation">,</span> timeV

<span class="token keyword">let</span> <span class="token punctuation">(</span>timeSV<span class="token punctuation">,</span> velSV<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">stormerVerlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
echo <span class="token string">"Time for Stormer Verlet integration is: "</span><span class="token punctuation">,</span> timeSV
echo <span class="token string">"Velocity for Stormer Verlet integration is: "</span><span class="token punctuation">,</span> velSV

<span class="token keyword">let</span> <span class="token punctuation">(</span>timeVV<span class="token punctuation">,</span> velVV<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">velocityVerlet</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
echo <span class="token string">"Time for velocity Verlet integration is: "</span><span class="token punctuation">,</span> timeVV
echo <span class="token string">"Velocity for velocity Verlet integration is: "</span><span class="token punctuation">,</span> velVV
</code></pre>
</div><div class="code-method-sample hidden" data-lang="lisp" data-name="Common Lisp"><pre class="language-"><code class="lang-lisp"><span class="token heading comment title">;;;; Verlet integration implementation in Common Lisp</span>

<span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">"Integrates Newton's equation for motion while pos &gt; 0 using Verlet integration."</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    with prev-pos = pos
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> pos <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment">;; The starting speed is assumed to be zero.</span>
    do <span class="token punctuation">(</span><span class="token car">psetf</span>
         pos <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> pos <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">-</span> prev-pos<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
         prev-pos pos<span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">stormer-verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">"Integrates Newton's equation for motion while pos &gt; 0 using the Stormer-Verlet method."</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    with prev-pos = pos
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    for vel = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> vel <span class="token punctuation">(</span><span class="token car">*</span> acc dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> pos <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment">;; Variables are changed simultaneously by 'psetf', so there's no need for a temporary variable.</span>
    do <span class="token punctuation">(</span><span class="token car">psetf</span>
         pos <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> pos <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">-</span> prev-pos<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
         prev-pos pos<span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token car">list</span> time vel<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">velocity-verlet</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">pos</span> <span class="token argument variable">acc</span> <span class="token argument variable">dt</span></span><span class="token punctuation">)</span></span>
  <span class="token string">"Integrates Newton's equation for motion while pos &gt; 0 using the velocity in calculations."</span>
  <span class="token punctuation">(</span><span class="token car">loop</span>
    for time = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> time dt<span class="token punctuation">)</span>
    for vel = <span class="token number">0</span> then <span class="token punctuation">(</span><span class="token car">incf</span> vel <span class="token punctuation">(</span><span class="token car">*</span> acc dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
    for p = pos then <span class="token punctuation">(</span><span class="token car">incf</span> p <span class="token punctuation">(</span><span class="token car">+</span> <span class="token punctuation">(</span><span class="token car">*</span> vel dt<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token car">*</span> <span class="token number">0.5</span> acc dt dt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    while <span class="token punctuation">(</span><span class="token car">&gt;</span> p <span class="token number">0</span><span class="token punctuation">)</span>
    finally <span class="token punctuation">(</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token car">list</span> time vel<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">"Time for Verlet integration: ~d~%"</span> <span class="token punctuation">(</span><span class="token car">verlet</span> <span class="token number">5</span> <span class="token number">-10</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token defvar"><span class="token keyword">defvar</span> <span class="token variable">stormer-verlet-result</span></span> <span class="token punctuation">(</span><span class="token car">stormer-verlet</span> <span class="token number">5</span> <span class="token number">-10</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">"Time for Stormer Verlet integration is: ~d~%"</span> <span class="token punctuation">(</span><span class="token car">first</span> stormer-verlet-result<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">"Velocity for Stormer Verlet integration is: ~d~%"</span> <span class="token punctuation">(</span><span class="token car">second</span> stormer-verlet-result<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token defvar"><span class="token keyword">defvar</span> <span class="token variable">velocity-verlet-result</span></span> <span class="token punctuation">(</span><span class="token car">velocity-verlet</span> <span class="token number">5</span> <span class="token number">-10</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">"Time for velocity Verlet integration is: ~d~%"</span> <span class="token punctuation">(</span><span class="token car">first</span> velocity-verlet-result<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token car">format</span> T <span class="token string">"Velocity for velocity Verlet integration is: ~d~%"</span> <span class="token punctuation">(</span><span class="token car">second</span> velocity-verlet-result<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
</div></div></div>


<script>
MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
</script>

<h2 id="license">License</h2>
<h5 id="code-examples">Code Examples</h5>
<p>The code examples are licensed under the MIT license (found in <a href="https://github.com/algorithm-archivists/algorithm-archive/blob/master/LICENSE.md" target="_blank">LICENSE.md</a>).</p>
<h5 id="text">Text</h5>
<p>The text of this chapter was written by <a href="https://github.com/leios" target="_blank">James Schloss</a> and is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
<p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"></a></p><p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><img class="center" src="./Verlet Integration · GitBook_files/CC-BY-SA_icon.svg"></a></p><p></p>
<h5 id="pull-requests">Pull Requests</h5>
<p>After initial licensing (<a href="https://github.com/algorithm-archivists/algorithm-archive/pull/560" target="_blank">#560</a>), the following pull requests have modified the text or graphics of this chapter:</p>
<ul>
<li>none</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class="search-results-count"></span> results matching "<span class="search-query"></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class="search-query"></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="https://www.algorithm-archive.org/contents/physics_solvers/physics_solvers.html" class="navigation navigation-prev " aria-label="Previous page: Physics Solvers">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="https://www.algorithm-archive.org/contents/quantum_systems/quantum_systems.html" class="navigation navigation-next " aria-label="Next page: Quantum Systems" style="margin-right: 17px;">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Verlet Integration","level":"1.15.1","depth":2,"next":{"title":"Quantum Systems","level":"1.15.2","depth":2,"path":"contents/quantum_systems/quantum_systems.md","ref":"contents/quantum_systems/quantum_systems.md","articles":[{"title":"Split-Operator Method","level":"1.15.2.1","depth":3,"path":"contents/split-operator_method/split-operator_method.md","ref":"contents/split-operator_method/split-operator_method.md","articles":[]}]},"previous":{"title":"Physics Solvers","level":"1.15","depth":1,"path":"contents/physics_solvers/physics_solvers.md","ref":"contents/physics_solvers/physics_solvers.md","articles":[{"title":"Verlet Integration","level":"1.15.1","depth":2,"path":"contents/verlet_integration/verlet_integration.md","ref":"contents/verlet_integration/verlet_integration.md","articles":[]},{"title":"Quantum Systems","level":"1.15.2","depth":2,"path":"contents/quantum_systems/quantum_systems.md","ref":"contents/quantum_systems/quantum_systems.md","articles":[{"title":"Split-Operator Method","level":"1.15.2.1","depth":3,"path":"contents/split-operator_method/split-operator_method.md","ref":"contents/split-operator_method/split-operator_method.md","articles":[]}]}]},"dir":"ltr"},"config":{"plugins":["fontsettings","mathjax@https://github.com/algorithm-archivists/plugin-mathjax","bibtex-cite","wordcount","api-language-selector@https://github.com/algorithm-archivists/gitbook-plugin-api-language-selector.git","include-codeblock","ga","bulk-redirect","prism","-highlight"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"api-language-selector":{"languages":[{"lang":"jl","name":"Julia","default":true},{"lang":"bash","name":"Bash"},{"lang":"cs","name":"C#"},{"lang":"cpp","name":"C++"},{"lang":"c","name":"C"},{"lang":"c8","name":"chip-8"},{"lang":"py","name":"Python"},{"lang":"js","name":"JavaScript"},{"lang":"scratch","name":"Scratch"},{"lang":"hs","name":"Haskell"},{"lang":"rs","name":"Rust"},{"lang":"ml","name":"OCaml"},{"lang":"java","name":"Java"},{"lang":"clj","name":"Clojure"},{"lang":"elm","name":"Elm"},{"lang":"LabVIEW","name":"LabVIEW"},{"lang":"d","name":"D"},{"lang":"go","name":"Go"},{"lang":"swift","name":"Swift"},{"lang":"racket","name":"Racket"},{"lang":"m","name":"Matlab"},{"lang":"r","name":"R"},{"lang":"ti83b","name":"TI-83 Basic"},{"lang":"lua","name":"Lua"},{"lang":"crystal","name":"Crystal"},{"lang":"php","name":"PHP"},{"lang":"lisp","name":"Common Lisp"},{"lang":"nim","name":"Nim"},{"lang":"asm-x64","name":"X86-64 Assembly"},{"lang":"f90","name":"Fortran90"},{"lang":"factor","name":"Factor"},{"lang":"ws","name":"Whitespace"},{"lang":"scala","name":"Scala"},{"lang":"emojic","name":"Emojicode"},{"lang":"lolcode","name":"LOLCODE"},{"lang":"piet","name":"Piet"},{"lang":"ss","name":"Scheme"},{"lang":"v","name":"Vlang"},{"lang":"coffee","name":"CoffeeScript"},{"lang":"kotlin","name":"Kotlin"}]},"prism":{"lang":{"asm-x64":"nasm"},"ignore":["emojicode","text"],"css":["prismjs/themes/prism-tomorrow.css"]},"wordcount":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"family":"sans","size":2,"theme":"white"},"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"bibtex-cite":{},"mathjax":{"forceSVG":false,"version":"2.6.1"},"ga":{"configuration":"auto","token":"UA-118252470-1"},"include-codeblock":{"check":false,"edit":false,"fixlang":true,"lang":"","template":"default","theme":"chrome","unindent":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","lunr":{"maxIndexSize":1000000000},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"bibCount":0,"variables":{},"bib":[{"citationKey":"CT1965","entryType":"ARTICLE","entryTags":{"TITLE":"An algorithm for the machine calculation of complex Fourier series","AUTHOR":"Cooley, James W and Tukey, John W","JOURNAL":"Mathematics of computation","VOLUME":"19","NUMBER":"90","PAGES":"297--301","YEAR":"1965","PUBLISHER":"JSTOR"}},{"citationKey":"JM1973","entryType":"ARTICLE","entryTags":{"TITLE":"On the identification of the convex hull of a finite set of points in the plane","AUTHOR":"Jarvis, Ray A","JOURNAL":"Information processing letters","VOLUME":"2","NUMBER":"1","PAGES":"18--21","YEAR":"1973","PUBLISHER":"Elsevier"}},{"citationKey":"GS1972","entryType":"ARTICLE","entryTags":{"TITLE":"An efficient algorithm for determining the convex hull of a finite planar set","AUTHOR":"Graham, Ronald L","JOURNAL":"Information processing letters","VOLUME":"1","NUMBER":"4","PAGES":"132--133","YEAR":"1972","PUBLISHER":"Elsevier"}}],"gitbook":"3.x.x"},"file":{"path":"contents/verlet_integration/verlet_integration.md","mtime":"2019-11-10T10:32:02.018Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-11-10T10:33:03.000Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="./Verlet Integration · GitBook_files/gitbook.js.descarga"></script>
    <script src="./Verlet Integration · GitBook_files/theme.js.descarga"></script>
    
        
        <script src="./Verlet Integration · GitBook_files/fontsettings.js.descarga"></script>
        
    
        
        <script src="./Verlet Integration · GitBook_files/MathJax.js.descarga"></script>
        
    
        
        <script src="./Verlet Integration · GitBook_files/plugin.js.descarga"></script>
        
    
        
        <script src="./Verlet Integration · GitBook_files/api-language-selector.js.descarga"></script>
        
    
        
        <script src="./Verlet Integration · GitBook_files/plugin.js(1).descarga"></script>
        
    
        
        <script src="./Verlet Integration · GitBook_files/search-engine.js.descarga"></script>
        
    
        
        <script src="./Verlet Integration · GitBook_files/search.js.descarga"></script>
        
    
        
        <script src="./Verlet Integration · GitBook_files/lunr.min.js.descarga"></script>
        
    
        
        <script src="./Verlet Integration · GitBook_files/search-lunr.js.descarga"></script>
        
    
        
        <script src="./Verlet Integration · GitBook_files/buttons.js.descarga"></script>
        
    

    


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Caligraphic, sans-serif;"></div></div></body></html>